<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="fit_hrg() fits a HRG to a given graph. It takes the specified
steps number of MCMC steps to perform the fitting, or a convergence
criteria if the specified number of steps is zero. fit_hrg() can start
from a given HRG, if this is given in the hrg() argument and the
start argument is TRUE."><title>Fit a hierarchical random graph model — fit_hrg • igraph</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a hierarchical random graph model — fit_hrg"><meta property="og:description" content="fit_hrg() fits a HRG to a given graph. It takes the specified
steps number of MCMC steps to perform the fitting, or a convergence
criteria if the specified number of steps is zero. fit_hrg() can start
from a given HRG, if this is given in the hrg() argument and the
start argument is TRUE."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">igraph</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.0.9004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/igraph.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/installation-troubleshooting.html">Installation troubleshooting</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/igraph/rigraph/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit a hierarchical random graph model</h1>
      <small class="dont-index">Source: <a href="https://github.com/igraph/rigraph/blob/HEAD/R/hrg.R" class="external-link"><code>R/hrg.R</code></a></small>
      <div class="d-none name"><code>fit_hrg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>fit_hrg()</code> fits a HRG to a given graph. It takes the specified
<code>steps</code> number of MCMC steps to perform the fitting, or a convergence
criteria if the specified number of steps is zero. <code>fit_hrg()</code> can start
from a given HRG, if this is given in the <code><a href="hrg.html">hrg()</a></code> argument and the
<code>start</code> argument is <code>TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_hrg</span><span class="op">(</span><span class="va">graph</span>, hrg <span class="op">=</span> <span class="cn">NULL</span>, start <span class="op">=</span> <span class="cn">FALSE</span>, steps <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>graph</dt>
<dd><p>The graph to fit the model to. Edge directions are ignored in
directed graphs.</p></dd>


<dt>hrg</dt>
<dd><p>A hierarchical random graph model, in the form of an
<code>igraphHRG</code> object. <code>fit_hrg()</code> allows this to be <code>NULL</code>, in
which case a random starting point is used for the fitting.</p></dd>


<dt>start</dt>
<dd><p>Logical, whether to start the fitting/sampling from the
supplied <code>igraphHRG</code> object, or from a random starting point.</p></dd>


<dt>steps</dt>
<dd><p>The number of MCMC steps to make. If this is zero, then the
MCMC procedure is performed until convergence.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>fit_hrg()</code> returns an <code>igraphHRG</code> object. This is a list
with the following members:</p>
<dl><dt>left</dt>
<dd><p>Vector that contains the left children of the internal
tree vertices. The first vertex is always the root vertex, so the
first element of the vector is the left child of the root
vertex. Internal vertices are denoted with negative numbers, starting
from -1 and going down, i.e. the root vertex is -1. Leaf vertices
are denoted by non-negative number, starting from zero and up.</p></dd>

<dt>right</dt>
<dd><p>Vector that contains the right children of the vertices,
with the same encoding as the <code>left</code> vector.</p></dd>

<dt>prob</dt>
<dd><p>The connection probabilities attached to the internal
vertices, the first number belongs to the root vertex (i.e. internal
vertex -1), the second to internal vertex -2, etc.</p></dd>

<dt>edges</dt>
<dd><p>The number of edges in the subtree below the given
internal vertex.</p></dd>

<dt>vertices</dt>
<dd><p>The number of vertices in the subtree below the
given internal vertex, including itself.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>A. Clauset, C. Moore, and M.E.J. Newman. Hierarchical structure
and the prediction of missing links in networks. <em>Nature</em> 453, 98--101
(2008);</p>
<p>A. Clauset, C. Moore, and M.E.J. Newman. Structural Inference of Hierarchies
in Networks. In E. M. Airoldi et al. (Eds.): ICML 2006 Ws, <em>Lecture
Notes in Computer Science</em> 4503, 1--13. Springer-Verlag, Berlin Heidelberg
(2007).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other hierarchical random graph functions: 
<code><a href="consensus_tree.html">consensus_tree</a>()</code>,
<code><a href="hrg-methods.html">hrg-methods</a></code>,
<code><a href="hrg_tree.html">hrg_tree</a>()</code>,
<code><a href="hrg.html">hrg</a>()</code>,
<code><a href="predict_edges.html">predict_edges</a>()</code>,
<code><a href="print.igraphHRGConsensus.html">print.igraphHRGConsensus</a>()</code>,
<code><a href="print.igraphHRG.html">print.igraphHRG</a>()</code>,
<code><a href="sample_hrg.html">sample_hrg</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## We are not running these examples any more, because they</span></span></span>
<span class="r-in"><span><span class="co">## take a long time (~15 seconds) to run and this is against the CRAN</span></span></span>
<span class="r-in"><span><span class="co">## repository policy. Copy and paste them by hand to your R prompt if</span></span></span>
<span class="r-in"><span><span class="co">## you want to run them.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## A graph with two dense groups</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="sample_gnp.html">sample_gnp</a></span><span class="op">(</span><span class="fl">10</span>, p <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="sample_gnp.html">sample_gnp</a></span><span class="op">(</span><span class="fl">10</span>, p <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hrg</span> <span class="op">&lt;-</span> <span class="fu">fit_hrg</span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hrg</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hierarchical random graph, at level 3:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g1        p=   0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> '- g12    p=0.44  7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    '- g14 p=0.12  2  3  6  5  4  1  10 9  8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> '- g17    p=0.78  20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    '- g13 p=0.35  15 14 19 11 18 17 12 16 13</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The consensus tree for it</span></span></span>
<span class="r-in"><span><span class="fu"><a href="consensus_tree.html">consensus_tree</a></span><span class="op">(</span><span class="va">g</span>, hrg <span class="op">=</span> <span class="va">hrg</span>, start <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $parents</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 20 20 20 20 20 20 20 20 20 20 21 21 21 21 21 21 21 21 21 21 22 22 -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  8793  9831 10000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hrg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hrg$left</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -12  -8  -5   0  -7 -10  10 -15   8 -11  11 -14  -3  -2 -18  -4 -13 -16  12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hrg$right</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] -17   1  14  -9  13  17  18   2   9  16 -19   6  -6   7   5   3  19   4  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hrg$prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.0000000 0.5714286 0.6666667 0.0000000 0.0000000 1.0000000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.0000000 1.0000000 1.0000000 0.0000000 0.4444444 0.3500000 0.1250000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 0.6000000 1.0000000 0.7777778 0.7500000 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hrg$edges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0 4 2 0 0 4 1 0 1 3 0 4 7 1 3 3 7 3 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hrg$vertices</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 20  8  4  3  3  5  2  7  2  4  3 10  9  9  6  4 10  5  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Prediction of missing edges</span></span></span>
<span class="r-in"><span><span class="va">g2</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_full_graph.html">make_full_graph</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="make_full_graph.html">make_full_graph</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="path.html">path</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="predict_edges.html">predict_edges</a></span><span class="op">(</span><span class="va">g2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $edges</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    5    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    4    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    2    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    3    5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    4    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    2    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    3    6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    2    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    4    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    2    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    4    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    3    8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    3    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    1    7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $prob</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.272648783 0.005001911 0.004942516 0.004785216 0.004763794 0.004210195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7] 0.004154408 0.004057616 0.003996802 0.003893010 0.003857092 0.003716136</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13] 0.003672164 0.003657983 0.003624458 0.003354700 0.003288983</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $hrg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hierarchical random graph, at level 3:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g1        p=   0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> '- g5     p=   1  2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    '- g7  p=   1  4 1 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> '- g3     p=0.67  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    '- g2  p=   1  8 6 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Tamás Nepusz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

